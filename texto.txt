import pygetwindow as gw
import time

print("--- INICIANDO VARREDURA DE JANELAS ---")
print("Certifique-se que a janela do Salus está aberta e visível.")
time.sleep(2)

todas_janelas = gw.getAllTitles()
encontrou = False

print(f"\nEncontrei {len(todas_janelas)} janelas ativas:\n")

for titulo in todas_janelas:
    # Remove espaços vazios no início e fim para ver o nome real
    titulo_limpo = titulo.strip()
    if titulo_limpo:
        print(f"--> [{titulo_limpo}]")
        
        # Teste de comparação flexível
        if "pedidos" in titulo_limpo.lower() and "remoto" in titulo_limpo.lower():
            print("\n✅✅✅ ACHEI! O Python vê esta janela como:")
            print(f"Nome exato: '{titulo_limpo}'")
            print("✅✅✅\n")
            encontrou = True

if not encontrou:
    print("\n❌ ERRO CRÍTICO: O Python NÃO conseguiu listar a janela do Salus.")
    print("SOLUÇÃO PROVÁVEL: Feche o VS Code/Terminal e abra novamente como ADMINISTRADOR.")
